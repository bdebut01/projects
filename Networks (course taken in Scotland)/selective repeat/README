Implements the Selective repeat protocol